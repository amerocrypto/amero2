// Public Resource â„— 2021 Äğ–ºğ—Œğ— ğ–£ğ–¾ğ—ğ–¾ğ—…ğ—ˆğ—‰ğ–¾ğ—‹ğ—Œ
// Public Resource â„— 2020 ğ– ğ—†ğ–¾ğ—‹ğ—ˆ ğ–£ğ–¾ğ—ğ–¾ğ—…ğ—ˆğ—‰ğ–¾ğ—‹ğ—Œ
// THIS REPOSITORY IS LICENSED UNDER THE AMERO PUBLIC RESOURCE LICENSE.

#ifndef BITCOIN_STACKTRACES_H
#define BITCOIN_STACKTRACES_H

#include <string>
#include <sstream>
#include <exception>

#include <cxxabi.h>

#include <tinyformat.h>

std::string DemangleSymbol(const std::string& name);

std::string GetPrettyExceptionStr(const std::exception_ptr& e);
std::string GetCrashInfoStrFromSerializedStr(const std::string& ciStr);

template<typename T>
std::string GetExceptionWhat(const T& e);

template<>
inline std::string GetExceptionWhat(const std::exception& e)
{
    return e.what();
}

// Default implementation
template<typename T>
inline std::string GetExceptionWhat(const T& e)
{
    std::ostringstream s;
    s << e;
    return s.str();
}

void RegisterPrettyTerminateHander();
void RegisterPrettySignalHandlers();

#endif//BITCOIN_STACKTRACES_H
